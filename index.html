<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="referrer" content="no-referrer" />
	<title>HKPHTÃ…GMMS USB1</title>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
		crossorigin="anonymous"></script>
	<script src="Loader.js"></script>
	<style>
		#hvaserdupaa video, #hvaserdupaa img {
			max-width: 50%;
			max-height: 50%;
			min-width: 50%;
			min-height: 50%;
		}

		body {
			text-align: center;
			font-family: 'Comic Sans MS', sans-serif;
		}

		#inspirasjon span {
			font-size: 30px;
			text-shadow: 1px 0px black;
			display: inline-block;
		}

		button {
			border: 30px dotted red;
			border-radius: 200px 100px 50px 1px;
			box-shadow: 5px 10px greenyellow;
			text-shadow: 50px 1px pink;
		}
	</style>
</head>

<body>
	<iframe width="1" height="1" src="https://www.youtube.com/embed/M8PaeEhBPqY?autoplay=1&loop=1&playlist=M8PaeEhBPqY"
		frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
	<div id="inspirasjon">Putte?</div>
	<marquee behavior="alternate">
		<button type="button" onclick="javascript:gjorAltSammem();">Gi meg mer da</button>
	</marquee>
	<br>
	<div id="hvorforgraaterdu">
		<label for="neglsaft">Lastem: </label>
		<progress id="neglsaft" max="100" value="0"></progress>
		<span id="hvormyeneglsaft"></span>
	</div>
	<div id="hvaserdupaa">
	</div>
	<!-- hitwebcounter Code START -->
	<a href="http://www.hitwebcounter.com" target="_blank">
		<img title="" Alt="" border="0" id="hvormangeda">
	</a>
	<script>
		//var PJOXY = 'https://cors.funkerikke.wtf:12345/'
		var PJOXY = 'https://api.allorigins.win/get?url=';
		//var PJOXY = 'https://pjoxy.fattig.cloud/'
		var API_URL = PJOXY + encodeURIComponent('http://a.4cdn.org/gif/catalog.json');
		var PASSORDEM = 'avangsert';
		var LYLLEHARAM = ['skolen', 'gore', 'rekt', 'war', 'gondola', 'ygyl', 'ylyl', 'boomer', 'birb', 'bird', 'caturday', 'fight'];
		var TYTTELEM = 'Putte?';
		var FARGEM = ['yellow', 'pink', 'red', 'blue', 'yellowgreen'];
		var BRA_URL = 'http://hitwebcounter.com/counter/counter.php?page=6975323&style=0044&nbdigits=6&type=page&initCount=0';
		var KJEDELYM_INTERNVALG = 1000;

		if (!Date.now) {
			Date.now = function() { return new Date().getTime(); }
		}

		var forrigeTaesj = Date.now() - KJEDELYM_INTERNVALG;
		var sistKatalogEndrem = "Thu, 01 Jan 1970 00:00:00 GMT";
		var katalogSjokoladeKakem;

		if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {
			var FILTEM = ['.gif'];
		} else {
			var FILTEM = ['.webm', '.gif'];
		}

		var isisTechnoRemix = function () {
			$('#neglsaft').attr('value', 0);
			$('#hvormyeneglsaft').html('0%');

			return new Promise(function (resolve, reject) {
				window.setTimeout(function() {
					$.ajax(
						{
							url: API_URL,
							method: 'GET'/*,
							beforeSend: function(jqXHR) {
								jqXHR.setRequestHeader('If-Modified-Since', sistKatalogEndrem);
							}*/
						})
						.done(function (data, textStatus, jqXHR) {
							sistKatalogEndrem = jqXHR.getResponseHeader('Last-Modified');

							if (data) {
								katalogSjokoladeKakem = data;
								resolve(data);
							} else {
								resolve(katalogSjokoladeKakem);
							}
						})
						.always(function () {
							forrigeTaesj = Date.now();
						})
						.fail(function () { reject('hold kjeft potethore') });
				}, KJEDELYM_INTERNVALG - (Date.now() - forrigeTaesj));
			});
		};

		var sorterOgHentKomplexemNSFW = function (dataKomplexem) {
			dataKomplexem = JSON.parse(dataKomplexem.contents);
			return new Promise(function(resolve) {
				var alleTraadem = [];
				dataKomplexem.map(function (enSydem, indexem) {
					alleTraadem = alleTraadem.concat(enSydem.threads);
				});
				var nestemAlleTraadem = [];
				alleTraadem.map(function (traad, indexem) {
					if (LYLLEHARAM.every((ordem) => (traad.com || '').toLowerCase().indexOf(ordem) === -1)) {
						nestemAlleTraadem.push(traad);
					}
				});
				var antallByldem = nestemAlleTraadem.map(traadem => traadem.images + 1);
				var elleveMennIKjeftem = [];
				antallByldem.reduce(function(a,b,i,d) { return elleveMennIKjeftem[i] = a+b; },0);
				var komplexem = elleveMennIKjeftem.findIndex(mindreverDighetSkompleXem => mindreverDighetSkompleXem >= Math.floor(Math.random() * elleveMennIKjeftem[elleveMennIKjeftem.length-1]));
				resolve(nestemAlleTraadem[komplexem]);
			});
		};

		var hentKomplexemByldem = function (komplexemObjektem) {
			var komplexemAPI = PJOXY + encodeURIComponent('http://a.4cdn.org/gif/thread/' + komplexemObjektem.no + '.json');

			return new Promise(function (braDa, blaest) {
				window.setTimeout(function() {
					$.ajax(
						{
							url: komplexemAPI,
							method: 'GET'
						})
						.done(function (data, textStatus, jqXHR) {
							//console.log(jqXHR.getResponseHeader('Last-Modified'));
							braDa(data);
						})
						.always(function () {
							forrigeTaesj = Date.now();
						})
						.fail(function () { blaest('hold kjeft jeg fant dem ikke drikk vestkyst') });
					}, KJEDELYM_INTERNVALG - (Date.now() - forrigeTaesj));
			});
		};

		var visMegForFaen = function (komplexemTraadem) {
			komplexemTraadem = JSON.parse(komplexemTraadem.contents);
			var alleKomplexemPostem = komplexemTraadem.posts.filter(function (komplexemElementym) {
				return komplexemElementym.hasOwnProperty('ext') && (FILTEM.indexOf(komplexemElementym.ext) !== -1);
			});
			if (!alleKomplexemPostem || !alleKomplexemPostem.length) {
				setTimeout(gjorAltSammem, 1000);
				return;
			}
			var eeeeenKomplexemBlantAlleKomplexemPostem = alleKomplexemPostem[Math.floor(Math.random() * alleKomplexemPostem.length)];
			var lenkem = `${eeeeenKomplexemBlantAlleKomplexemPostem.tim}${eeeeenKomplexemBlantAlleKomplexemPostem.ext}`;

			console.log(`SAUS: http://boards.4chan.org/gif/thread/${komplexemTraadem.posts[0].no}#p${eeeeenKomplexemBlantAlleKomplexemPostem.no}`);

			var vestkystMensViVentem;

			if (eeeeenKomplexemBlantAlleKomplexemPostem.ext.indexOf('.gif') !== -1) {
				vestkystMensViVentem = new Image();
			} else {
				vestkystMensViVentem = new Video();
			}

			vestkystMensViVentem.load('http://i.4cdn.org/gif/' + lenkem,
			{
				notComputable: function() {
					$('#neglsaft').attr('value', 0);
					$('#hvormyeneglsaft').html('funker ik');
				},
				progress: function(loaded, total) {
					var neglsaft = parseInt((loaded / total) * 100);
					$('#neglsaft').attr('value', neglsaft);
					$('#hvormyeneglsaft').html(neglsaft + '%');
				},
				complete: function(obj) {
					$('#hvaserdupaa').empty();
					
					var enke = new TextDecoder('utf-8');
					obj = enke.decode(obj.contents);

					if (obj.tagName === 'VIDEO') {
						obj.autoplay = true;
						obj.muted = true;
						obj.loop = true;
					}

					$('#hvaserdupaa').append(obj);
				},
				end: function() {
				},
				error: function() {
					$('#neglsaft').attr('value', 100);
					$('#hvormyeneglsaft').html('forfor klarte jeg ikke laste');
				}
			});
		}

		var gjorAltSammem = function () {
			$('body').css('background', FARGEM[Math.floor(Math.random() * FARGEM.length)]);
			$('button').css('background', FARGEM[Math.floor(Math.random() * FARGEM.length)]);
			$('button').css('border-color', FARGEM[Math.floor(Math.random() * FARGEM.length)]);
			$('button').css('color', FARGEM[Math.floor(Math.random() * FARGEM.length)]);
			$('#inspirasjon').html(TYTTELEM.split('').map(function (bokstavem) {
				return `<span style='transform: rotate(${Math.floor(Math.random() * 20) - 10}deg); color: ${FARGEM[Math.floor(Math.random() * FARGEM.length)]};'>${bokstavem}</span>`;
			}).join(''));

			$(document).find("#hvormangeda").attr('src', BRA_URL + '&timestamp=' + new Date().getTime());

			isisTechnoRemix()
				.then(sorterOgHentKomplexemNSFW)
				.then(hentKomplexemByldem)
				.then(visMegForFaen)
				.catch(alert);
		};

		gjorAltSammem();
	</script>
</body>
</html>
